from helper import DatabricksSchemaGenerator, load_config_from_file

def main():
    config = load_config_from_file("schema_config.json")
    if not config:
        print("Invalid or missing config.")
        return

    generator = DatabricksSchemaGenerator(
        excel_file_path=config.get("excel_file_path"),
        output_base_folder=config.get("output_folder", "generated_schemas"),
        sheet_name=config.get("sheet_name"),
        categories=config.get("categories"),
        default_datatype_col_suffix=config.get("default_datatype_col_suffix", " - Data Type") # Pass new parameter
    )
    generator.run()

if __name__ == "__main__":
    main()
