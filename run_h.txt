from helper import DatabricksSchemaGenerator, load_config_from_file

def main():
    config = load_config_from_file("schema_config.json")
    if not config:
        print("Invalid or missing config.")
        return

    # Check if using new format with category list
    if "categories" in config and isinstance(config["categories"], list):
        generator = DatabricksSchemaGenerator(
            excel_file_path=config.get("excel_file_path"),
            output_base_folder=config.get("output_folder", "generated_schemas"),
            sheet_name=config.get("sheet_name"),
            category_list=config.get("categories"),
            default_datatype_col_suffix=config.get("default_datatype_col_suffix", " - Data Type")
        )
    else:
        # Use old format with detailed category configuration
        generator = DatabricksSchemaGenerator(
            excel_file_path=config.get("excel_file_path"),
            output_base_folder=config.get("output_folder", "generated_schemas"),
            sheet_name=config.get("sheet_name"),
            categories=config.get("categories")
        )
    
    generator.run()

if __name__ == "__main__":
    main()
