#1st

# Add this at the end of your sidebar, after the navigation
st.sidebar.markdown("---")
if st.sidebar.button("Clear All Data", type="secondary"):
    # Clear all session state variables
    for key in list(st.session_state.keys()):
        del st.session_state[key]
    
    # Force garbage collection
    gc.collect()
    
    # Show success message
    st.sidebar.success("All data cleared! Refreshing page...")
    
    # Rerun the app
    st.rerun()


#2nd
# Add this after the main navigation sidebar
st.sidebar.markdown("---")
st.sidebar.subheader("Clear Data")

clear_options = st.sidebar.expander("Clear Options")
with clear_options:
    col1, col2 = st.columns(2)
    
    with col1:
        clear_results = st.checkbox("Extraction Results", value=True)
        clear_edits = st.checkbox("Manual Edits", value=True)
    
    with col2:
        clear_downloads = st.checkbox("Download Data", value=True)
        clear_files = st.checkbox("File References", value=True)

if st.sidebar.button("Clear Selected Data", type="secondary"):
    cleared_something = False
    
    if clear_results and 'all_pdf_results' in st.session_state:
        del st.session_state.all_pdf_results
        del st.session_state.results_df if 'results_df' in st.session_state else None
        cleared_something = True
    
    if clear_edits and 'edited_data' in st.session_state:
        del st.session_state.edited_data
        del st.session_state.manual_edit_tracking if 'manual_edit_tracking' in st.session_state else None
        cleared_something = True
    
    if clear_downloads:
        for key in ['text_zip', 'csv_data', 'original_csv', 'comparison_csv', 'verification_csv', 'individual_csvs_zip']:
            if key in st.session_state:
                del st.session_state[key]
                cleared_something = True
    
    if clear_files and 'original_files' in st.session_state:
        del st.session_state.original_files
        cleared_something = True
    
    # Force garbage collection
    gc.collect()
    
    if cleared_something:
        st.sidebar.success("Selected data cleared! Refreshing page...")
        st.rerun()
    else:
        st.sidebar.info("No data was selected to clear.")

# Add a button for complete reset
if st.sidebar.button("Reset Everything", type="primary"):
    # Clear all session state variables
    for key in list(st.session_state.keys()):
        del st.session_state[key]
    
    # Force garbage collection
    gc.collect()
    
    # Show success message
    st.sidebar.success("Application fully reset! Refreshing page...")
    
    # Rerun the app
    st.rerun()
