from azure.ai.formrecognizer import DocumentModelAdministrationClient
from azure.core.credentials import AzureKeyCredential

def diagnose_azure_document_intelligence():
    # Replace with your actual credentials
    endpoint = "your_document_intelligence_endpoint"
    key = "your_document_intelligence_key"
    model_id = "DCM"

    try:
        # Create administration client
        document_model_admin_client = DocumentModelAdministrationClient(
            endpoint=endpoint, 
            credential=AzureKeyCredential(key)
        )

        # List available models
        print("Available Models:")
        models = list(document_model_admin_client.list_models())
        
        for model in models:
            print(f"Model ID: {model.model_id}")
            print(f"Description: {model.description}")
            print(f"Created: {model.created_date_time}")
            print("-" * 50)

    except Exception as e:
        print("Diagnostic Checks:")
        print(f"1. Endpoint Validation: FAILED")
        print(f"2. Access Key Validation: FAILED")
        print(f"3. Error Details: {str(e)}")
        
        # Detailed Error Analysis
        if "AuthenticationFailed" in str(e):
            print("Possible Authentication Issues:")
            print("- Verify your Azure credentials")
            print("- Check access key")
        
        if "ResourceNotFound" in str(e):
            print("Possible Resource Issues:")
            print("- Confirm Model ID exists")
            print("- Verify Document Intelligence resource configuration")

# Run diagnostics
diagnose_azure_document_intelligence()
