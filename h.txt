"""
FIELD CONFIGURATIONS FOR DOCUMENT EXTRACTION
============================================

USERS: Edit this file to add/modify field configurations
DEVELOPERS: Don't edit this file - edit prompt_builder.py instead

To add a new field:
1. Add field name to config.json
2. Add field configuration below in FIELD_LIBRARY
3. Run main.py - that's it!
"""

# ============================================================================
# FIELD LIBRARY - EDIT THIS TO ADD/MODIFY FIELDS
# ============================================================================

FIELD_LIBRARY = {
    "name": {
        "description": "Full name as it appears on the document",
        "examples": ["JOHN MICHAEL DOE", "Jane Smith", "李明"],
        "format": "First Middle Last or Last First format",
        "extraction_hints": [
            "May be split across multiple lines",
            "Check for 'Surname' and 'Given Names' labels",
            "Look for 'Full Name' or 'Name of Holder' sections",
            "Sometimes appears as 'Nom' or 'Name of Holder'",
            "Can be in format: Surname, Given Names OR Given Names Surname"
        ],
        "confidence_factors": [
            "Clear text with proper spacing",
            "Consistent formatting across document",
            "Matches expected name pattern",
            "Found near expected location (top of document)"
        ]
    },
    
    "nationality": {
        "description": "Country of citizenship",
        "examples": ["USA", "United States of America", "GBR", "United Kingdom", "IND", "India"],
        "format": "Full country name or ISO 3166-1 alpha-3 code",
        "extraction_hints": [
            "Look for 'Nationality', 'Country', 'País', 'Nationalité'",
            "May match issuing country",
            "Can be in native language or English",
            "Often appears as 3-letter code (USA, GBR, IND, etc.)",
            "Check near top section or in personal details area"
        ],
        "confidence_factors": [
            "Clearly stated on document",
            "Matches document issuing country",
            "Valid country name/code",
            "Consistent with document language"
        ]
    }
    
    # ========================================================================
    # TO ADD MORE FIELDS:
    # ========================================================================
    # 1. Add field name to config.json "fields" array
    # 2. Add field configuration here in FIELD_LIBRARY
    # 3. Run python main.py
    # 
    # Template:
    # "your_field_name": {
    #     "description": "Brief description",
    #     "examples": ["Example 1", "Example 2"],
    #     "format": "Expected format",
    #     "extraction_hints": [
    #         "Where to look",
    #         "What labels to find"
    #     ],
    #     "confidence_factors": [
    #         "What makes extraction confident"
    #     ]
    # }
}


# ============================================================================
# SYSTEM PROMPT CONFIGURATION
# ============================================================================

SYSTEM_PROMPT_CONFIG = {
    "role": "You are an expert document extraction system specialized in identity documents, passports, licenses, and official records.",
    
    "extraction_rules": [
        "THINK STEP-BY-STEP before extracting each field:",
        "  Step 1: Identify where this field typically appears",
        "  Step 2: Look for the field label (e.g., 'Name:', 'Nationality:')",
        "  Step 3: Extract the value immediately after or near the label",
        "  Step 4: Verify the format matches expected pattern",
        "  Step 5: Assign confidence based on clarity and format match",
        "",
        "Extract EXACT values as they appear in the document",
        "For each field, provide: value (extracted text or empty string) and confidence (0.0 to 1.0)",
        "Use similar document examples to understand field patterns",
        "If a field is not present, return empty string for value and 0.0 for confidence",
        "Be conservative with confidence scores - only use >0.9 when certain"
    ],
    
    "confidence_guide": {
        "0.95-1.0": "Crystal clear text, perfect format match, verified with examples",
        "0.80-0.94": "Clear text but format slightly different from examples",
        "0.60-0.79": "Readable text but some uncertainty in interpretation",
        "0.40-0.59": "Partially visible or format doesn't match expectations",
        "0.20-0.39": "Very uncertain, possibly OCR error",
        "0.0-0.19": "Field not found or completely illegible"
    },
    
    "output_format": 'Return ONLY a JSON object: {"field_name": {"value": "...", "confidence": 0.95}, ...}',
    
    "restrictions": "Do NOT include any explanations, markdown formatting, or additional text. Just the pure JSON object."
}


# ============================================================================
# DOCUMENT TYPE SPECIFIC HINTS
# ============================================================================

DOCUMENT_TYPE_HINTS = {
    "passport": {
        "title": "PASSPORT DOCUMENT EXTRACTION",
        "special_considerations": [
            "Passport numbers may include letters and numbers",
            "Dates are often in DD MMM YYYY format (e.g., 15 JAN 1990)",
            "Look for MRZ (Machine Readable Zone) at bottom",
            "Names may be split (Surname / Given Names)"
        ]
    },
    
    "license": {
        "title": "DRIVER'S LICENSE EXTRACTION",
        "special_considerations": [
            "License numbers vary by state/country",
            "May contain multiple date fields",
            "Address may span multiple lines",
            "License class indicates vehicle types"
        ]
    },
    
    "id_card": {
        "title": "ID CARD EXTRACTION",
        "special_considerations": [
            "ID formats vary significantly by country",
            "May have both front and back text",
            "Look for official stamps or holograms",
            "National ID numbers follow country-specific patterns"
        ]
    }
}


# ============================================================================
# RAG PROMPT TEMPLATES
# ============================================================================

RAG_PROMPT_TEMPLATE = {
    "intro": "FEW-SHOT LEARNING: Study these {num_docs} similar documents carefully. They show you EXACTLY how to extract fields from this type of document.",
    
    "example_header": "═══════════════════════════════════════════════════════════\nREFERENCE EXAMPLES (Learn the pattern):\n═══════════════════════════════════════════════════════════",
    
    "transition": "\n═══════════════════════════════════════════════════════════\nNOW APPLY WHAT YOU LEARNED TO THIS NEW DOCUMENT:\n═══════════════════════════════════════════════════════════\n",
    
    "instructions": [
        "STEP-BY-STEP EXTRACTION PROCESS:",
        "",
        "1. OBSERVE the examples above:",
        "   - Notice WHERE each field appears in the document",
        "   - See HOW the field is labeled",
        "   - Understand the EXPECTED FORMAT",
        "",
        "2. FIND the same patterns in the new document:",
        "   - Look for similar labels",
        "   - Check similar locations",
        "   - Match the format",
        "",
        "3. EXTRACT with confidence:",
        "   - If it matches examples perfectly → confidence 0.95-1.0",
        "   - If it matches but format differs slightly → confidence 0.80-0.94",
        "   - If uncertain or unclear → confidence <0.80",
        "",
        "4. VERIFY your extraction:",
        "   - Does the value make sense?",
        "   - Does it match the expected format?",
        "   - Is it similar to the examples?"
    ],
    
    "reminder": "\nIMPORTANT: Return ONLY the JSON object. No explanations. No markdown. Just pure JSON."
}


STANDARD_PROMPT_TEMPLATE = {
    "header": "Extract the required fields from this document:",
    "reminder": "Remember to return ONLY the JSON object with extracted fields and confidence scores."
}
