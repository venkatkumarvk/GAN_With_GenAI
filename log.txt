import os
import logging
from logging.handlers import RotatingFileHandler
from datetime import datetime

def setup_logging(config):
    """
    Configure logging based on configuration
    
    :param config: Configuration dictionary
    """
    # Ensure log directory exists
    log_dir = config['paths'].get('log_dir', 'logs')
    os.makedirs(log_dir, exist_ok=True)

    # Create log filename with timestamp
    timestamp = datetime.now().strftime("%Y%m%d")
    log_filename = os.path.join(log_dir, f"document_classification_{timestamp}.log")

    # Configure logging
    logging_config = config.get('logging', {})
    log_level = getattr(logging, logging_config.get('level', 'INFO').upper())
    log_format = logging_config.get('format', '%(asctime)s - %(name)s - %(levelname)s - %(message)s')

    # Configure root logger
    logging.basicConfig(
        level=log_level,
        format=log_format,
        handlers=[
            # File handler with rotation
            RotatingFileHandler(
                log_filename, 
                maxBytes=10*1024*1024,  # 10 MB
                backupCount=5
            ),
            # Console handler
            logging.StreamHandler()
        ]
    )

    # Optional: Set logging for specific libraries
    logging.getLogger('azure').setLevel(logging.WARNING)
    logging.getLogger('openai').setLevel(logging.WARNING)
    logging.getLogger('urllib3').setLevel(logging.WARNING)

    return log_filename

def get_logger(name):
    """
    Get a logger with the specified name
    
    :param name: Name of the logger
    :return: Configured logger
    """
    return logging.getLogger(name)


----
help

import json
import logging
from logger_config import setup_logging, get_logger
from azure_keyvault import load_config_with_keyvault

def load_config(config_path):
    """
    Load configuration file with Azure Key Vault support
    
    :param config_path: Path to the configuration file
    :return: Processed configuration dictionary
    """
    try:
        # Use the new Key Vault-aware configuration loader
        config = load_config_with_keyvault(config_path)
        
        # Setup logging based on the loaded configuration
        log_filename = setup_logging(config)
        
        # Log configuration loading
        logger = get_logger(__name__)
        logger.info(f"Configuration loaded successfully from {config_path}")
        logger.info(f"Logging to file: {log_filename}")
        
        return config
    except Exception as e:
        # Fallback logging if main logging setup fails
        logging.basicConfig(level=logging.ERROR)
        logger = logging.getLogger(__name__)
        logger.error(f"Failed to load configuration: {e}")
        raise


----

main

from helper import get_logger

# In a class
class YourClass:
    def __init__(self):
        self.logger = get_logger(self.__class__.__name__)
    
    def some_method(self):
        self.logger.info("This is an info message")
        self.logger.error("This is an error message")

# In a function
def some_function():
    logger = get_logger(__name__)
    logger.debug("Debug message")
    logger.warning("Warning message")

----

{
    "paths": {
        "log_dir": "/path/to/logs",  // Ensure this path exists or is writable
        ...
    },
    "logging": {
        "level": "DEBUG",  // Can be DEBUG, INFO, WARNING, ERROR, CRITICAL
        "format": "%(asctime)s - %(name)s - %(levelname)s - %(message)s",
        "file": "document_classification.log"
    },
    ...
}

