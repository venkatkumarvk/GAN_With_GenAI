"""
FLEXIBLE FIELD LIBRARY - Medical Credentials
=============================================

EASY TO EXTEND: Just add new fields to FIELD_LIBRARY below
No need to change anything else - system automatically adapts!

TO ADD NEW FIELDS:
1. Add field definition to FIELD_LIBRARY (copy existing format)
2. Add field name to config.json "fields" list
3. Done! System automatically uses new fields
"""

# =============================================================================
# FIELD LIBRARY - Add/Remove Fields Here
# =============================================================================

FIELD_LIBRARY = {
    # =========================================================================
    # PERSONAL INFORMATION
    # =========================================================================
    
    "first_name": {
        "description": "First/Given name of the individual",
        "examples": ["John", "Mary", "Robert", "Jennifer", "Michael"],
        "format": "Capitalized text, may include middle initial",
        "extraction_hints": [
            "May be split across multiple lines",
            "Check for 'First Name' and 'Given Name' labels",
            "Look for 'Full Name' or 'Name of Holder' sections",
            "Sometimes appears as 'Nom' or 'Name of Holder'",
            "Can be in format: First Middle Last OR Given Names Surname"
        ],
        "confidence_factors": [
            "Clear text with proper spacing",
            "Consistent formatting across document",
            "Matches expected name pattern",
            "Found near expected location (top of document)"
        ]
    },
    
    "last_name": {
        "description": "Last/Family name of the individual",
        "examples": ["Smith", "Johnson", "Williams", "Brown", "Garcia"],
        "format": "Capitalized text, may include suffixes (Jr., Sr., III, MD, DO)",
        "extraction_hints": [
            "May be split across multiple lines",
            "Check for 'Last Name', 'Surname', 'Family Name' labels",
            "Look for 'Full Name' or 'Name of Holder' sections",
            "May include professional suffixes (MD, DO, DDS)",
            "Sometimes appears as 'Surname' or after given names"
        ],
        "confidence_factors": [
            "Clear text with proper spacing",
            "Consistent formatting across document",
            "Matches expected surname pattern",
            "Found near expected location"
        ]
    },
    
    "email": {
        "description": "Email address for contact",
        "examples": ["john.doe@hospital.com", "mary.smith@clinic.org", "doctor@medical.edu"],
        "format": "Standard email format: username@domain.com",
        "extraction_hints": [
            "Look for 'Email', 'E-mail', 'Email Address' labels",
            "Must contain @ symbol and domain",
            "Usually in contact information section",
            "May be labeled as 'Electronic Mail' or 'Contact Email'",
            "Validate format if possible (username@domain.extension)"
        ],
        "confidence_factors": [
            "Contains @ symbol",
            "Has valid domain structure",
            "Clear and readable text",
            "Found in contact section"
        ]
    },
    
    "cell": {
        "description": "Cell/Mobile phone number",
        "examples": ["(555) 123-4567", "555-123-4567", "5551234567", "+1-555-123-4567"],
        "format": "10 digits, may include formatting: (XXX) XXX-XXXX or XXX-XXX-XXXX",
        "extraction_hints": [
            "Look for 'Cell', 'Mobile', 'Cell Phone', 'Mobile Number' labels",
            "Extract 10-digit number, preserve formatting if present",
            "May be labeled as 'Primary Phone' or 'Contact Number'",
            "Could include country code (+1)",
            "Sometimes in format: (XXX) XXX-XXXX or XXX.XXX.XXXX"
        ],
        "confidence_factors": [
            "Contains 10 digits",
            "Has standard phone formatting",
            "Clear and complete number",
            "Found in contact section"
        ]
    },
    
    "birth_date": {
        "description": "Date of birth",
        "examples": ["01/15/1985", "1985-01-15", "January 15, 1985", "15-Jan-1985"],
        "format": "MM/DD/YYYY or YYYY-MM-DD or Month DD, YYYY",
        "extraction_hints": [
            "Look for 'DOB', 'Date of Birth', 'Birth Date', 'Born' labels",
            "Convert to consistent format: MM/DD/YYYY",
            "Validate date is reasonable (person is 25-80 years old for doctors)",
            "May be formatted as DD/MM/YYYY in some documents",
            "Check personal information section"
        ],
        "confidence_factors": [
            "Valid date format",
            "Reasonable age for medical professional (25-80)",
            "Clear and complete date",
            "Found in personal info section"
        ]
    },
    
    "birth_place": {
        "description": "Complete birth place (city, state/province, country)",
        "examples": ["New York, NY, USA", "London, UK", "Toronto, ON, Canada", "Chicago, IL"],
        "format": "City, State/Province, Country (or partial if not all available)",
        "extraction_hints": [
            "Look for 'Place of Birth', 'Birth Place', 'Born in', 'POB' labels",
            "May be combined field or separate fields",
            "Include all location details available",
            "Sometimes split into city, state, country fields",
            "May only have city or city+state (extract what's available)"
        ],
        "confidence_factors": [
            "Complete location information",
            "Standard place name format",
            "Clear and readable",
            "Found in personal info section"
        ]
    },
    
    "birth_city": {
        "description": "City of birth",
        "examples": ["New York", "Los Angeles", "Chicago", "Houston", "Phoenix"],
        "format": "City name only",
        "extraction_hints": [
            "Look for 'Birth City', 'City of Birth' labels",
            "Extract city portion from full birth place if available",
            "May be in separate 'City' field under birth information",
            "Usually appears before state in address format",
            "Check both 'Birth Place' and separate 'City' fields"
        ],
        "confidence_factors": [
            "Valid city name",
            "Consistent with birth_place if available",
            "Clear text",
            "Found in personal info"
        ]
    },
    
    "birth_state_province": {
        "description": "State or Province of birth",
        "examples": ["California", "CA", "New York", "NY", "Ontario", "ON", "Texas"],
        "format": "Full state name or 2-letter abbreviation",
        "extraction_hints": [
            "Look for 'Birth State', 'State/Province of Birth', 'State' labels",
            "May be full name or 2-letter abbreviation",
            "Extract from birth_place if combined field",
            "Usually follows city in address format",
            "Check for both full names and abbreviations"
        ],
        "confidence_factors": [
            "Valid state/province name or abbreviation",
            "Consistent with birth_place and birth_city",
            "Standard formatting",
            "Found in personal info"
        ]
    },
    
    "birth_country": {
        "description": "Country of birth",
        "examples": ["USA", "United States", "Canada", "United Kingdom", "Mexico", "India"],
        "format": "Full country name or standard abbreviation (USA, UK, etc.)",
        "extraction_hints": [
            "Look for 'Birth Country', 'Country of Birth', 'Country' labels",
            "May be full name (United States) or abbreviation (USA)",
            "Extract from birth_place if combined field",
            "Usually last component in full birth place",
            "Accept common variations (US, USA, United States)"
        ],
        "confidence_factors": [
            "Valid country name",
            "Consistent with birth_place",
            "Standard country format",
            "Found in personal info"
        ]
    },
    
    "citizenship": {
        "description": "Citizenship/Nationality status",
        "examples": ["US Citizen", "USA", "Canadian", "Permanent Resident", "Naturalized Citizen"],
        "format": "Country name or citizenship status",
        "extraction_hints": [
            "Look for 'Citizenship', 'Nationality', 'Citizen of', 'Status' labels",
            "May indicate status: 'US Citizen', 'Permanent Resident', 'Naturalized'",
            "Different from birth country (naturalization possible)",
            "May be checkbox field or written text",
            "Sometimes in immigration/status section"
        ],
        "confidence_factors": [
            "Valid citizenship status",
            "Standard format",
            "Clear indication of status",
            "Found in personal or legal section"
        ]
    },
    
    "degree": {
        "description": "Highest educational degree in medicine/healthcare",
        "examples": ["MD", "DO", "MBBS", "PhD", "DDS", "PharmD", "RN", "PA", "NP"],
        "format": "Degree abbreviation or full name",
        "extraction_hints": [
            "Look for 'Degree', 'Education', 'Qualification', 'Professional Degree' labels",
            "Common medical degrees: MD, DO, MBBS, DDS, PharmD",
            "Allied health: RN, PA, NP, BSN, MSN",
            "May appear after name with comma (John Doe, MD)",
            "Check education section or credentials area"
        ],
        "confidence_factors": [
            "Valid medical/healthcare degree",
            "Standard abbreviation format",
            "Matches professional context",
            "Found in education or credentials section"
        ]
    },
    
    "gender": {
        "description": "Gender/Sex of individual",
        "examples": ["Male", "Female", "M", "F"],
        "format": "Male/Female or M/F",
        "extraction_hints": [
            "Look for 'Gender', 'Sex', 'M/F', checkboxes",
            "May be checkbox, single letter, or full word",
            "Standardize to full word if possible (M→Male, F→Female)",
            "Usually in personal information section",
            "May be indicated by checked box or circled option"
        ],
        "confidence_factors": [
            "Clear indication of gender",
            "Standard format (Male/Female or M/F)",
            "Found in personal info section",
            "Unambiguous value"
        ]
    },
    
    "ssn": {
        "description": "Social Security Number (often partially masked for privacy)",
        "examples": ["XXX-XX-1234", "1234", "***-**-1234", "SSN: 1234"],
        "format": "Usually last 4 digits only: XXXX or full: XXX-XX-XXXX",
        "extraction_hints": [
            "Look for 'SSN', 'Social Security', 'SS#', 'SSN#' labels",
            "Often only last 4 digits shown for privacy (****-1234)",
            "Format: XXX-XX-XXXX or just last 4 digits",
            "Handle masked values (***-**-1234 or XXX-XX-1234)",
            "May be fully masked with only last 4 visible"
        ],
        "confidence_factors": [
            "Correct format (full or last 4)",
            "Found in personal/identification section",
            "Clear digits (not corrupted)",
            "Proper masking if applicable"
        ]
    },
    
    # =========================================================================
    # STATE LICENSE
    # =========================================================================
    
    "state_license_number": {
        "description": "State medical/professional license number",
        "examples": ["A12345", "MD123456", "123456-A", "NY-123456", "RN-123456"],
        "format": "Alphanumeric, format varies by state and profession",
        "extraction_hints": [
            "Look in 'State License', 'Medical License', 'Professional License' section",
            "Labels: 'License Number', 'License #', 'State Lic #', 'Lic. No.'",
            "Format varies by state (letters, numbers, hyphens)",
            "Primary license for practicing medicine/healthcare",
            "May have prefix indicating state (CA-, NY-) or profession (MD-, RN-)"
        ],
        "confidence_factors": [
            "Found in license section",
            "Alphanumeric format matching state patterns",
            "Clear and complete number",
            "Labeled as license number"
        ]
    },
    
    "state_license_state": {
        "description": "State/jurisdiction that issued the professional license",
        "examples": ["CA", "California", "NY", "New York", "TX", "Texas", "FL"],
        "format": "2-letter state abbreviation or full state name",
        "extraction_hints": [
            "Look in 'State License' section for 'State', 'Issued by', 'Jurisdiction'",
            "Usually 2-letter abbreviation (CA, NY, TX, FL)",
            "May be full state name",
            "Sometimes embedded in license number (NY-123456)",
            "Check both explicit 'State' field and context"
        ],
        "confidence_factors": [
            "Valid US state abbreviation or name",
            "Found in license section",
            "Consistent with license number format",
            "Clear and unambiguous"
        ]
    },
    
    "state_license_expiration": {
        "description": "Expiration date of state professional license",
        "examples": ["12/31/2025", "2025-12-31", "December 31, 2025", "12-31-25"],
        "format": "MM/DD/YYYY or YYYY-MM-DD",
        "extraction_hints": [
            "Look in 'State License' section for 'Expiration', 'Exp Date', 'Valid Until'",
            "Convert to consistent format: MM/DD/YYYY",
            "Should be future date (current license)",
            "May be labeled 'Renewal Date' or 'Expires'",
            "Typically 1-3 years from issue date"
        ],
        "confidence_factors": [
            "Valid future date",
            "Standard date format",
            "Found in license section",
            "Reasonable expiration period (1-5 years out)"
        ]
    },
    
    # =========================================================================
    # DEA LICENSE
    # =========================================================================
    
    "dea_license_number": {
        "description": "DEA (Drug Enforcement Administration) registration number",
        "examples": ["AB1234563", "FD1234567", "BD9876543", "FB1234567"],
        "format": "Exactly 2 letters + 7 digits (9 characters total)",
        "extraction_hints": [
            "Look in 'DEA License', 'DEA Registration', 'DEA #' section",
            "Format: 2 letters followed by 7 numbers (AB1234563)",
            "First letter indicates type: A=pharmacy, B=hospital, F=practitioner, M=mid-level",
            "Second letter often matches first letter of last name",
            "Required for prescribing controlled substances"
        ],
        "confidence_factors": [
            "Exactly 9 characters (2 letters + 7 digits)",
            "Found in DEA section",
            "Matches DEA format rules",
            "Clear and complete number"
        ]
    },
    
    "dea_license_state": {
        "description": "State associated with DEA registration",
        "examples": ["CA", "California", "NY", "TX", "Florida", "Illinois"],
        "format": "2-letter state abbreviation or full state name",
        "extraction_hints": [
            "Look in 'DEA License' section for 'State', 'Practice State'",
            "Usually same as primary practice state",
            "May match state_license_state",
            "Sometimes embedded in DEA section header",
            "Can have multiple DEA numbers for different states"
        ],
        "confidence_factors": [
            "Valid US state",
            "Found in DEA section",
            "Consistent with practice location",
            "Standard format"
        ]
    },
    
    "dea_license_expiration": {
        "description": "DEA registration expiration date",
        "examples": ["06/30/2026", "2026-06-30", "June 30, 2026", "06-30-2026"],
        "format": "MM/DD/YYYY or YYYY-MM-DD",
        "extraction_hints": [
            "Look in 'DEA License' section for 'Expiration', 'Renewal Date', 'Valid Until'",
            "DEA renewals are typically every 3 years",
            "Convert to consistent format: MM/DD/YYYY",
            "Should be future date for active DEA",
            "May say 'Expires' or 'Exp Date'"
        ],
        "confidence_factors": [
            "Valid future date",
            "Approximately 3 years from issue",
            "Found in DEA section",
            "Standard date format"
        ]
    },
    
    # =========================================================================
    # CDS LICENSE
    # =========================================================================
    
    "cds_license_number": {
        "description": "CDS (Controlled Dangerous Substances) state license number",
        "examples": ["CDS123456", "123456-CDS", "C-123456", "MD-CDS-12345"],
        "format": "Alphanumeric, format varies by state",
        "extraction_hints": [
            "Look in 'CDS License', 'Controlled Substances', 'CDS Registration' section",
            "State-level license for prescribing controlled substances",
            "Format varies significantly by state",
            "Some states don't require separate CDS (use DEA only)",
            "Common in: Maryland, New Jersey, Texas"
        ],
        "confidence_factors": [
            "Found in CDS/controlled substances section",
            "Alphanumeric format",
            "State-specific pattern",
            "Clear and complete"
        ]
    },
    
    "cds_license_state": {
        "description": "State that issued CDS license",
        "examples": ["MD", "Maryland", "NJ", "New Jersey", "TX", "Texas"],
        "format": "2-letter state abbreviation or full state name",
        "extraction_hints": [
            "Look in 'CDS License' section for 'State', 'Issued by'",
            "Usually same as primary practice state",
            "Required in specific states: MD, NJ, TX, IL",
            "May match state_license_state",
            "Not all states require separate CDS license"
        ],
        "confidence_factors": [
            "Valid US state",
            "Found in CDS section",
            "State known to require CDS",
            "Consistent with practice location"
        ]
    },
    
    "cds_license_expiration": {
        "description": "CDS license expiration date",
        "examples": ["12/31/2025", "2025-12-31", "Dec 31, 2025"],
        "format": "MM/DD/YYYY or YYYY-MM-DD",
        "extraction_hints": [
            "Look in 'CDS License' section for 'Expiration', 'Valid Until', 'Expires'",
            "Renewal period varies by state (1-3 years typical)",
            "Convert to consistent format: MM/DD/YYYY",
            "Should be future date for active license",
            "May align with state license or DEA expiration"
        ],
        "confidence_factors": [
            "Valid future date",
            "Found in CDS section",
            "Reasonable renewal period",
            "Standard date format"
        ]
    },
    
    # =========================================================================
    # OTHER CREDENTIALS
    # =========================================================================
    
    "other_credential_type": {
        "description": "Type of additional credential, certification, or qualification",
        "examples": ["ACLS", "BLS", "PALS", "NRP", "ATLS", "Board Certified", "Fellow"],
        "format": "Credential name or abbreviation",
        "extraction_hints": [
            "Look in 'Other Credentials', 'Certifications', 'Additional Licenses' sections",
            "Common life support: ACLS, BLS, PALS, NRP, ATLS",
            "Specialty: Board Certification, Fellowship",
            "Hospital privileges, teaching credentials",
            "List primary/most important if multiple present"
        ],
        "confidence_factors": [
            "Recognized credential name",
            "Found in credentials/certifications section",
            "Standard abbreviation or full name",
            "Medical/healthcare related"
        ]
    },
    
    "other_credential_state": {
        "description": "State or jurisdiction for additional credential (if applicable)",
        "examples": ["CA", "National", "NY", "Multi-State", "AHA", "N/A"],
        "format": "State abbreviation, 'National', 'Multi-State', or certifying body",
        "extraction_hints": [
            "Many credentials are national (ACLS, BLS from AHA)",
            "Some are state-specific or regional",
            "May say 'National', 'All States', 'AHA', 'ACEP'",
            "For board certifications: often 'National' or certifying board",
            "Use 'NA' if not applicable or not specified"
        ],
        "confidence_factors": [
            "Valid jurisdiction indicator",
            "Consistent with credential type",
            "Found in credentials section",
            "Standard format"
        ]
    },
    
    "other_credential_expiration": {
        "description": "Expiration date of additional credential",
        "examples": ["03/31/2025", "2025-03-31", "March 31, 2025"],
        "format": "MM/DD/YYYY or YYYY-MM-DD",
        "extraction_hints": [
            "Life support certs (ACLS, BLS, PALS) expire every 2 years",
            "Board certifications expire every 5-10 years (or continuous)",
            "Convert to consistent format: MM/DD/YYYY",
            "Some credentials don't expire (use 'NA')",
            "Check 'Valid Until', 'Expires', 'Renewal Date'"
        ],
        "confidence_factors": [
            "Valid future date",
            "Reasonable for credential type",
            "Found in credentials section",
            "Standard date format"
        ]
    },
    
    # =========================================================================
    # BOARD CERTIFICATION
    # =========================================================================
    
    "board_cert_name": {
        "description": "Name of board certification organization",
        "examples": [
            "American Board of Internal Medicine", "ABIM",
            "American Board of Surgery", "ABS",
            "American Board of Family Medicine", "ABFM",
            "American Board of Pediatrics"
        ],
        "format": "Full board name or standard abbreviation",
        "extraction_hints": [
            "Look in 'Board Certification', 'Board Certified', 'Specialty Board' section",
            "Usually starts with 'American Board of...'",
            "Common abbreviations: ABIM, ABS, ABFM, ABP, ABEM",
            "Indicates specialist certification beyond basic license",
            "Separate from other credentials and licenses"
        ],
        "confidence_factors": [
            "Recognized board name",
            "Found in board certification section",
            "Standard format or abbreviation",
            "Medical specialty board"
        ]
    },
    
    "board_cert_specialty": {
        "description": "Medical specialty in which provider is board certified",
        "examples": [
            "Internal Medicine", "Surgery", "Family Medicine",
            "Pediatrics", "Emergency Medicine", "Anesthesiology",
            "Cardiology", "Gastroenterology"
        ],
        "format": "Specialty name (may include subspecialty)",
        "extraction_hints": [
            "Look in 'Board Certification' section under 'Specialty', 'Field'",
            "Primary specialties: Internal Medicine, Surgery, Pediatrics, Family Medicine",
            "Subspecialties: Cardiology (under IM), Trauma Surgery (under Surgery)",
            "May list multiple if dual certified (use primary)",
            "Should align with board_cert_name"
        ],
        "confidence_factors": [
            "Valid medical specialty name",
            "Matches certifying board",
            "Found in board certification section",
            "Standard specialty nomenclature"
        ]
    }
    
    # =============================================================================
    # TO ADD MORE FIELDS: Just copy a field block above and modify
    # System automatically counts and uses all fields in FIELD_LIBRARY
    # =============================================================================
}


# =============================================================================
# SYSTEM PROMPT CONFIGURATION - FULLY DYNAMIC
# =============================================================================

SYSTEM_PROMPT_CONFIG = {
    "role": "You are an expert medical credentialing specialist with years of experience extracting information from healthcare provider documents. You have deep knowledge of medical licenses, DEA registrations, CDS permits, board certifications, and credential verification.",
    
    "extraction_rules": [
        "Extract EXACTLY what you see in the document - do not infer or guess",
        "If a field is not present or cannot be found with confidence, use 'NA'",
        "For dates, convert to MM/DD/YYYY format when possible",
        "For states, you may use either full name or 2-letter abbreviation",
        "Preserve original formatting for license numbers (letters, numbers, hyphens)",
        "Return 'NA' for ANY field you cannot find or are uncertain about (confidence < 0.50)",
        "Do not leave any field empty - use 'NA' for missing values",
        "Pay special attention to license sections: State License, DEA License, CDS License",
        "Board certifications are usually in a separate section from licenses",
        "Each license type (State, DEA, CDS) has three components: number, state, expiration"
    ],
    
    "confidence_guide": {
        "0.95-1.00": "Exact match found, clear and unambiguous, properly labeled",
        "0.85-0.94": "Strong match, minor formatting differences, clear context",
        "0.70-0.84": "Likely match, some interpretation needed, reasonable confidence",
        "0.50-0.69": "Possible match, moderate uncertainty, ambiguous context",
        "below 0.50": "Field not found or too uncertain - MUST use 'NA'"
    },
    
    "output_format": """
Return a JSON object with ALL configured fields. For each field provide:
{
  "field_name": {
    "value": "extracted value or 'NA'",
    "confidence": 0.XX
  }
}

CRITICAL RULES:
- Return 'NA' with confidence 0.50 for any field not found
- ALL configured fields MUST be present in response
- No field should be null or empty - use 'NA'
- Dates in MM/DD/YYYY format
- License numbers: preserve exact format with hyphens/letters
""",
    
    "restrictions": "Return ONLY the JSON object. No additional text, explanations, preamble, or markdown formatting (no ```json tags)."
}


# =============================================================================
# DOCUMENT TYPE HINTS
# =============================================================================

DOCUMENT_TYPE_HINTS = {
    "medical_credentials": {
        "title": "MEDICAL CREDENTIALING DOCUMENT",
        "special_considerations": [
            "These documents contain sensitive PHI (Protected Health Information)",
            "License sections are clearly separated: State License, DEA, CDS",
            "Board certifications appear in separate section from licenses",
            "Multiple licenses possible for multi-state practice",
            "Some fields may be intentionally masked for privacy (SSN shows last 4 only)",
            "Expiration dates are critical - verify they are future dates",
            "DEA numbers follow strict format: 2 letters + 7 digits (9 total)",
            "CDS licenses only required in certain states (MD, NJ, TX, IL)",
            "Use 'NA' for any field not applicable or not found",
            "Each license type has: number, state, expiration (3 fields per license)"
        ]
    }
}


# =============================================================================
# RAG PROMPT TEMPLATES
# =============================================================================

RAG_PROMPT_TEMPLATE = {
    "intro": "You have access to {num_docs} similar medical credential documents that have been successfully processed. Learn from their extraction patterns.",
    
    "example_header": "SIMILAR DOCUMENTS AND THEIR EXTRACTIONS:",
    
    "transition": "Now extract from the CURRENT document using the same careful approach shown above.",
    
    "instructions": [
        "Follow the same extraction patterns demonstrated in the examples",
        "Return 'NA' for any field not found (as shown in examples)",
        "Maintain consistent date formatting: MM/DD/YYYY",
        "Match the confidence scoring approach from examples",
        "Ensure ALL configured fields are present in your response",
        "Pay attention to how examples handled missing fields (always 'NA', not null)"
    ],
    
    "reminder": "Return ONLY the JSON object with all configured fields. Use 'NA' for missing values. No markdown formatting."
}

STANDARD_PROMPT_TEMPLATE = {
    "header": "Extract the configured fields from this medical credentialing document:",
    "reminder": "Return ONLY the JSON object with all configured fields. Use 'NA' for any field not found. No markdown formatting."
}


# =============================================================================
# DYNAMIC HELPER FUNCTIONS - Auto-adapt to field count
# =============================================================================

def get_field_count():
    """Get current number of fields (dynamic)"""
    return len(FIELD_LIBRARY)


def validate_fields():
    """Validate all fields in FIELD_LIBRARY"""
    all_valid = True
    for field_name, field_config in FIELD_LIBRARY.items():
        required_keys = ['description', 'examples', 'format', 'extraction_hints', 'confidence_factors']
        missing_keys = [k for k in required_keys if k not in field_config]
        
        if missing_keys:
            print(f"❌ Field '{field_name}' missing: {missing_keys}")
            all_valid = False
    
    field_count = get_field_count()
    if all_valid:
        print(f"✅ All {field_count} fields defined correctly")
    
    return all_valid


def print_field_summary():
    """Print summary of all fields (dynamic)"""
    field_count = get_field_count()
    print("\n" + "="*80)
    print(f"MEDICAL CREDENTIALING FIELDS - {field_count} TOTAL")
    print("="*80)
    
    for idx, (field_name, field_config) in enumerate(FIELD_LIBRARY.items(), 1):
        print(f"{idx}. {field_name}: {field_config['description']}")
    
    print("\n" + "="*80)
    print(f"Total: {field_count} fields configured")
    print("="*80)


def get_field_names():
    """Get list of all field names (for config.json)"""
    return list(FIELD_LIBRARY.keys())


# Run validation if executed directly
if __name__ == "__main__":
    print("="*80)
    print("FLEXIBLE FIELD LIBRARY - VALIDATION")
    print("="*80)
    
    # Validate
    is_valid = validate_fields()
    
    if is_valid:
        # Print summary
        print_field_summary()
        
        # Show how to use
        print("\n" + "="*80)
        print("USAGE EXAMPLE")
        print("="*80)
        print("\nTo add new fields:")
        print("1. Copy an existing field block in FIELD_LIBRARY")
        print("2. Modify the field_name and all values")
        print("3. Add field_name to config.json 'fields' list")
        print("4. Done! System automatically uses it")
        
        print("\nField names for config.json:")
        print(get_field_names())
        
        print("\n✅ Field library is production-ready and flexible!")
    else:
        print("\n❌ Validation failed!")


-----

{
  "azure_blob": {
    "connection_string": "YOUR_BLOB_CONNECTION_STRING",
    "inputcontainer": "inputcontainer",
    "outputcontainer": "outputcontainer"
  },
  "azure_document_intelligence": {
    "endpoint": "YOUR_DOC_INTEL_ENDPOINT",
    "key": "YOUR_DOC_INTEL_KEY"
  },
  "azure_openai_gpt": {
    "endpoint": "YOUR_OPENAI_ENDPOINT",
    "api_key": "YOUR_OPENAI_KEY",
    "api_version": "2024-02-01",
    "deployment_name": "gpt-4o"
  },
  "azure_openai_embedding": {
    "endpoint": "YOUR_OPENAI_ENDPOINT",
    "api_key": "YOUR_OPENAI_KEY",
    "api_version": "2024-02-01",
    "deployment_name": "text-embedding-3-large",
    "dimension": 3072
  },
  "azure_search": {
    "endpoint": "YOUR_SEARCH_ENDPOINT",
    "api_key": "YOUR_SEARCH_KEY",
    "index_strategy": "universal",
    "universal_index_name": "documents_universal",
    "auto_delete_days": 30,
    "enable_auto_cleanup": true
  },
  "extraction": {
    "fields": [
      "first_name",
      "last_name",
      "email",
      "cell",
      "birth_date",
      "birth_place",
      "birth_city",
      "birth_state_province",
      "birth_country",
      "citizenship",
      "degree",
      "gender",
      "ssn",
      "state_license_number",
      "state_license_state",
      "state_license_expiration",
      "dea_license_number",
      "dea_license_state",
      "dea_license_expiration",
      "cds_license_number",
      "cds_license_state",
      "cds_license_expiration",
      "other_credential_type",
      "other_credential_state",
      "other_credential_expiration",
      "board_cert_name",
      "board_cert_specialty"
    ],
    "confidence_threshold": 0.50,
    "min_text_length": 10,
    "na_value": "NA"
  },
  "rag": {
    "mode": "text",
    "top_k": 3,
    "similarity_threshold": 0.70,
    "chunk_size": 1000,
    "chunk_overlap": 200,
    "max_chunks_per_doc": 5
  },
  "costs": {
    "ocr_per_page": 0.01,
    "embedding_per_1k_tokens": 0.0001,
    "gpt4o_input_per_1k_tokens": 0.0025,
    "gpt4o_output_per_1k_tokens": 0.01
  },
  "processing": {
    "max_doc_length_chars": 12000,
    "max_prompt_tokens": 7000,
    "batch_size": 10,
    "enable_chunking": true,
    "enable_logging": true
  }
}
